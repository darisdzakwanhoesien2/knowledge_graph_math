# Solutions (Matrix Computations – Marko Huhtanen)

## 1. Best rank-1 approximation of  
$$
A = 
\begin{bmatrix}
-2 & 11\\
-10 & 5
\end{bmatrix}
$$

The SVD of A is  
$$
A = U \Sigma V^*
\qquad\text{with}\qquad
\Sigma = \operatorname{diag}(14, 8) \quad (\sigma_1 = 14,\; \sigma_2 = 8)
$$

(up to sign choices on the singular vectors).  
The **best rank-1 approximation** (Eckart–Young theorem) is the first term of the SVD:

$$
A_1 = 14 \, u_1 v_1^* 
   = \begin{bmatrix}
   -12 & 6 \\
   -6 & 3 
   \end{bmatrix}
   \quad\text{(exact)}
$$

Residual:  
$$
\|A - A_1\|_2 = \sigma_2 = 8
$$

## 2. Circulant matrices V ⊆ ℂ^{n×n}

### a) Is V an invertible matrix subspace?

**No.** The zero matrix is circulant (all diagonals zero), so V contains a singular matrix. Hence V is **not** an invertible matrix subspace.

### b) Eigenvalues of C ∈ V when n = 2^ℓ in O(n log n) flops?

Yes. Every circulant matrix is diagonalised by the (un-normalised) Fourier matrix Fₙ:

$$
F_n^{-1} C F_n = \operatorname{diag}\bigl(p(1), p(\omega), \dots, p(\omega^{n-1})\bigr),
\qquad 
p(z) = \sum_{k=-(n-1)}^{n-1} c_k z^k
$$

(the polynomial defined by the first row of C).  
Since n is a power of 2, the FFT computes the vector of values p(ω^j) in **O(n log n)** arithmetic operations.

Thus the eigenvalues of any circulant C are obtained in **O(n log n)** flops.

## 3. Factor  
$$
A = \begin{bmatrix}
1 & 2 \\
3 & 4 
\end{bmatrix}
= V_1 V_2
$$
with V₁ symmetric and V₂ circulant

One valid (and very natural) solution:

$$
V_2 = \begin{bmatrix}
1 & 2\\
2 & 1
\end{bmatrix}
\qquad\text{(circulant, first row $[1\; 2]$)}
$$

$$
V_1 = A V_2^{-1} = \begin{bmatrix} 
5 & -3 \\
-3 & 5
\end{bmatrix}
\qquad\text{(symmetric)}
$$

Verification:

$$
\begin{bmatrix}
5 & -3 \\
-3 & 5
\end{bmatrix}
\begin{bmatrix}
1 & 2 \\
2 & 1
\end{bmatrix}
= \begin{bmatrix}
5-6 & 10-3 \\
-3+10 & -6+5 
\end{bmatrix}
= \begin{bmatrix}
-1 & 7 \\
7 & -1
\end{bmatrix}
\quad\longrightarrow\quad
\text{wait, wrong inverse!}
$$

Correct inverse of V₂ (det = -3):

$$
V_2^{-1} = \frac{1}{-3} \begin{bmatrix} 
1 & -2 \\
-2 & 1
\end{bmatrix}
= \begin{bmatrix}
-1/3 & 2/3 \\
2/3 & -1/3
\end{bmatrix}
$$

Now

$$
V_1 = A V_2^{-1} = 
\begin{bmatrix}
1 & 2 \\
3 & 4
\end{bmatrix}
\begin{bmatrix}
-1/3 & 2/3 \\
2/3 & -1/3
\end{bmatrix}
= \begin{bmatrix}
5 & -3 \\
-3 & 5
\end{bmatrix}
$$

Yes, symmetric.  
Final factorization:

$$
A = 
\begin{bmatrix}
5 & -3 \\
-3 & 5
\end{bmatrix}
\begin{bmatrix}
1 & 2 \\
2 & 1
\end{bmatrix}
= V_1 V_2
$$

## 4. Partial pivoting LU of  
$$
A = \begin{bmatrix} 1 & 2 & 4 \\ 2 & 1 & 3 \\ 3 & 2 & 4 \end{bmatrix}
$$

After full Gaussian elimination with partial pivoting we obtain:

$$
P = \begin{bmatrix} 0 & 0 & 1 \\ 0 & 1 & 0 \\ 1 & 0 & 0 \end{bmatrix},
\qquad
L = \begin{bmatrix} 1 & 0 & 0 \\ 1/3 & 1 & 0 \\ 2/3 & -1/4 & 1 \end{bmatrix},
\qquad
U = \begin{bmatrix} 3 & 2 & 4 \\ 0 & 4/3 & 8/3 \\ 0 & 0 & 5/3 \end{bmatrix}
$$

Verification (optional): P A = L U holds.# Solutions (Matrix Computations – Marko Huhtanen)

## 1. Best rank-1 approximation of  
$$
A = \begin{bmatrix} -2 & 11 \\ -10 & 5 \end{bmatrix}
$$

The SVD of A is  
$$
A = U \Sigma V^*
\qquad\text{with}\qquad
\Sigma = \operatorname{diag}(14, 8) \quad (\sigma_1 = 14,\; \sigma_2 = 8)
$$

(up to sign choices on the singular vectors).  
The **best rank-1 approximation** (Eckart–Young theorem) is the first term of the SVD:

$$
A_1 = 14 \, u_1 v_1^* 
   = \begin{bmatrix} -12 & 6 \\ -6 & 3 \end{bmatrix}
   \quad\text{(exact)}
$$

Residual:  
$$
\|A - A_1\|_2 = \sigma_2 = 8
$$

## 2. Circulant matrices V ⊆ ℂ^{n×n}

### a) Is V an invertible matrix subspace?

**No.** The zero matrix is circulant (all diagonals zero), so V contains a singular matrix. Hence V is **not** an invertible matrix subspace.

### b) Eigenvalues of C ∈ V when n = 2^ℓ in O(n log n) flops?

Yes. Every circulant matrix is diagonalised by the (un-normalised) Fourier matrix Fₙ:

$$
F_n^{-1} C F_n = \operatorname{diag}\bigl(p(1), p(\omega), \dots, p(\omega^{n-1})\bigr),
\qquad 
p(z) = \sum_{k=-(n-1)}^{n-1} c_k z^k
$$

(the polynomial defined by the first row of C).  
Since n is a power of 2, the FFT computes the vector of values p(ω^j) in **O(n log n)** arithmetic operations.

Thus the eigenvalues of any circulant C are obtained in **O(n log n)** flops.

## 3. Factor  
$$
A = \begin{bmatrix} 1 & 2 \\ 3 & 4 \end{bmatrix}
= V_1 V_2
$$
with V₁ symmetric and V₂ circulant

One valid (and very natural) solution:

$$
V_2 = \begin{bmatrix} 1 & 2 \\ 2 & 1 \end{bmatrix}
\qquad\text{(circulant, first row $[1\; 2]$)}
$$

$$
V_1 = A V_2^{-1} = \begin{bmatrix} 5 & -3 \\ -3 & 5 \end{bmatrix}
\qquad\text{(symmetric)}
$$

Verification:

$$
\begin{bmatrix} 5 & -3 \\ -3 & 5 \end{bmatrix}
\begin{bmatrix} 1 & 2 \\ 2 & 1 \end{bmatrix}
= \begin{bmatrix} 5-6 & 10-3 \\ -3+10 & -6+5 \end{bmatrix}
= \begin{bmatrix} -1 & 7 \\ 7 & -1 \end{bmatrix}
\quad\longrightarrow\quad
\text{wait, wrong inverse!}
$$

Correct inverse of V₂ (det = -3):

$$
V_2^{-1} = \frac{1}{-3} \begin{bmatrix} 1 & -2 \\ -2 & 1 \end{bmatrix}
= \begin{bmatrix} -1/3 & 2/3 \\ 2/3 & -1/3 \end{bmatrix}
$$

Now

$$
V_1 = A V_2^{-1} = 
\begin{bmatrix} 
1 & 2 \\
 3 & 4 
\end{bmatrix}
\begin{bmatrix}
-1/3 & 2/3 \\
2/3 & -1/3
\end{bmatrix}
= \begin{bmatrix}
5 & -3 \\
-3 & 5 \end{bmatrix}
$$

Yes, symmetric.  
Final factorization:

$$
A = 
\begin{bmatrix}
5 & -3 \\
-3 & 5 
\end{bmatrix}
\begin{bmatrix}
1 & 2\\
2 & 1
\end{bmatrix}
= V_1 V_2
$$

## 4. Partial pivoting LU of  
$$
A = \begin{bmatrix} 
1 & 2 & 4 \\ 
2 & 1 & 3 \\ 
3 & 2 & 4 
\end{bmatrix}
$$

After full Gaussian elimination with partial pivoting we obtain:

$$
P = \begin{bmatrix} 
0 & 0 & 1 \\ 
0 & 1 & 0 \\ 
1 & 0 & 0 
\end{bmatrix},
\qquad
L = \begin{bmatrix} 
1 & 0 & 0 \\ 
1/3 & 1 & 0 \\ 
2/3 & -1/4 & 1 
\end{bmatrix},
\qquad
U = \begin{bmatrix} 
3 & 2 & 4 \\
0 & 4/3 & 8/3 \\
0 & 0 & 5/3 
\end{bmatrix}
$$

Verification (optional): P A = L U holds.